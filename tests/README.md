# æµ‹è¯•æ–‡ä»¶è¯´æ˜

æœ¬ç›®å½•åŒ…å«é¡¹ç›®çš„å„ç§æµ‹è¯•æ–‡ä»¶ï¼Œæ¶µç›–å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œäº¤äº’å¼æµ‹è¯•ã€‚

## ğŸ“ æ–‡ä»¶åˆ—è¡¨

### è‡ªåŠ¨åŒ–æµ‹è¯•

| æ–‡ä»¶ | åŠŸèƒ½ | ç±»å‹ |
|------|------|------|
| `test_core.py` | æ ¸å¿ƒåŠŸèƒ½æµ‹è¯• | å•å…ƒæµ‹è¯• |
| `coordinate_test.py` | åæ ‡ç³»ç»Ÿæµ‹è¯• | å•å…ƒæµ‹è¯• |
| `integration_test.py` | é›†æˆæµ‹è¯• | é›†æˆæµ‹è¯• |
| `test_end_to_end.py` | ç«¯åˆ°ç«¯æµ‹è¯• (8ä¸ªæµ‹è¯•ç”¨ä¾‹) | E2Eæµ‹è¯• |

### äº¤äº’å¼æµ‹è¯•

| æ–‡ä»¶ | åŠŸèƒ½ | ç‰¹æ€§ |
|------|------|------|
| `test_habitat_interactive.py` | åŸºç¡€äº¤äº’å¼æŸ¥çœ‹å™¨ | WASDæ§åˆ¶ã€OpenCVæ˜¾ç¤º |
| `test_habitat_interactive_enhanced.py` | **å¢å¼ºäº¤äº’å¼æŸ¥çœ‹å™¨** | âœ… åŒæ‘„åƒå¤´ã€âœ… NavMeshã€âœ… æœºå™¨ç‹—è·Ÿéš |

### å¯åŠ¨è„šæœ¬

| æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|
| `run_interactive_test.sh` | å¯åŠ¨åŸºç¡€æŸ¥çœ‹å™¨ |
| `run_enhanced_viewer.sh` | **å¯åŠ¨å¢å¼ºæŸ¥çœ‹å™¨** |

### æ–‡æ¡£

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `QUICK_START.md` | å¿«é€Ÿå¼€å§‹æŒ‡å— |
| `INTERACTIVE_TEST_README.md` | äº¤äº’å¼æµ‹è¯•è¯´æ˜ |
| `HABITAT_TEST_GUIDE.md` | Habitatæµ‹è¯•æŒ‡å— |
| `RUN_INTERACTIVE_TEST.md` | è¿è¡Œè¯´æ˜ |
| `ENHANCED_VIEWER_GUIDE.md` | **å¢å¼ºæŸ¥çœ‹å™¨æŒ‡å—** |
| `VIEWER_COMPARISON.md` | **æŸ¥çœ‹å™¨å¯¹æ¯”è¯´æ˜** |
| `DUAL_CAMERA_GUIDE.md` | **åŒæ‘„åƒå¤´åŠŸèƒ½è¯´æ˜** â­ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests/

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest tests/test_core.py

# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
python3 tests/test_end_to_end.py
```

### è¿è¡Œäº¤äº’å¼æµ‹è¯•

#### æ–¹å¼1: åŸºç¡€æŸ¥çœ‹å™¨ (ç®€å•åœºæ™¯æµè§ˆ)

```bash
# ä½¿ç”¨è„šæœ¬å¯åŠ¨
bash tests/run_interactive_test.sh

# æˆ–ç›´æ¥è¿è¡Œ
python3 tests/test_habitat_interactive.py
```

**åŠŸèƒ½**: WASDæ§åˆ¶ã€å®æ—¶æ˜¾ç¤ºã€ç»Ÿè®¡ä¿¡æ¯

#### æ–¹å¼2: å¢å¼ºæŸ¥çœ‹å™¨ (æ¨è - å®Œæ•´åŠŸèƒ½ + åŒæ‘„åƒå¤´)

```bash
# ä½¿ç”¨è„šæœ¬å¯åŠ¨
bash tests/run_enhanced_viewer.sh

# æˆ–ç›´æ¥è¿è¡Œ
python3 tests/test_habitat_interactive_enhanced.py
```

**åŠŸèƒ½**: 
- ğŸ“¹ **åŒæ‘„åƒå¤´è§†è§’** (å‰ç½®RGB + åç½®ä¿¯è§†)
- ğŸ—ºï¸ NavMeshè®¡ç®—ä¸å¯è§†åŒ–
- ğŸ¤– æœºå™¨ç‹—è·Ÿéš
- ğŸ² ä½ç½®é‡‡æ ·

## ğŸ® äº¤äº’å¼æ§åˆ¶è¯´æ˜

### åŸºç¡€æŸ¥çœ‹å™¨ (test_habitat_interactive.py)

| æŒ‰é”® | åŠŸèƒ½ |
|------|------|
| W | å‰è¿› (0.25m) |
| S | åé€€ (0.25m) |
| A | å·¦è½¬ (10Â°) |
| D | å³è½¬ (10Â°) |
| ESC | é€€å‡º |

### å¢å¼ºæŸ¥çœ‹å™¨ (test_habitat_interactive_enhanced.py) â­

| æŒ‰é”® | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| W | å‰è¿› | æœºå™¨ç‹—åŒæ­¥è·Ÿéš |
| S | åé€€ | æœºå™¨ç‹—åŒæ­¥è·Ÿéš |
| A | å·¦è½¬ | æœºå™¨ç‹—åŒæ­¥æ—‹è½¬ |
| D | å³è½¬ | æœºå™¨ç‹—åŒæ­¥æ—‹è½¬ |
| **N** | **åˆ‡æ¢NavMesh** | æ˜¾ç¤º/éšè—å¯é€šè¡ŒåŒºåŸŸ |
| **Shift+N** | **é‡ç®—NavMesh** | é‡æ–°è®¡ç®—å¯¼èˆªç½‘æ ¼ |
| **Alt+N** | **éšæœºä½ç½®** | ä¼ é€åˆ°éšæœºå¯é€šè¡Œç‚¹ |
| ESC | é€€å‡º | æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ |

## ğŸ“Š æµ‹è¯•ç»“æœ

### ç«¯åˆ°ç«¯æµ‹è¯• (test_end_to_end.py)

æœ€è¿‘è¿è¡Œç»“æœ: **6/8 é€šè¿‡**

| æµ‹è¯• | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| é…ç½®åŠ è½½ | âœ… | æˆåŠŸåŠ è½½æ‰€æœ‰é…ç½®æ–‡ä»¶ |
| æ–‡ä»¶å­˜åœ¨æ€§ | âœ… | åœºæ™¯å’Œæœºå™¨äººæ–‡ä»¶å­˜åœ¨ |
| ç¯å¢ƒåˆ›å»º | âš ï¸ | Habitatç¯å¢ƒç¼ºå°‘æ–¹æ³• |
| è·¯å¾„è§„åˆ’å™¨ | âœ… | A*è§„åˆ’å™¨å·¥ä½œæ­£å¸¸ |
| Agentæ§åˆ¶ | âœ… | åŠ¨ä½œæ§åˆ¶æ­£å¸¸ |
| å¯¼èˆªå¾ªç¯ | âœ… | ä¸»å¾ªç¯è¿è¡Œæ­£å¸¸ |
| VLMè¾“å…¥ | âœ… | å›¾åƒæ•°æ®æ ¼å¼æ­£ç¡® |
| VLMè¾“å‡º | âœ… | å†³ç­–æ ¼å¼æ­£ç¡® |

## ğŸ†š æŸ¥çœ‹å™¨å¯¹æ¯”

è¯¦ç»†å¯¹æ¯”è¯·å‚è€ƒ: [`VIEWER_COMPARISON.md`](VIEWER_COMPARISON.md)

### å¿«é€Ÿå¯¹æ¯”

| ç‰¹æ€§ | åŸºç¡€ç‰ˆ | å¢å¼ºç‰ˆ |
|------|--------|--------|
| WASDæ§åˆ¶ | âœ… | âœ… |
| å®æ—¶æ˜¾ç¤º | âœ… | âœ… |
| NavMeshè®¡ç®— | âŒ | âœ… |
| NavMeshå¯è§†åŒ– | âŒ | âœ… |
| æœºå™¨ç‹—è·Ÿéš | âŒ | âœ… |
| ä½ç½®é‡‡æ · | âŒ | âœ… |
| å¯åŠ¨æ—¶é—´ | å¿« (~2ç§’) | ç¨æ…¢ (~3ç§’) |
| é€‚ç”¨åœºæ™¯ | ç®€å•æµè§ˆ | **å¯¼èˆªæµ‹è¯•** |

### ä½¿ç”¨å»ºè®®

- **å¿«é€Ÿåœºæ™¯éªŒè¯** â†’ ä½¿ç”¨åŸºç¡€ç‰ˆ
- **å¯¼èˆªç³»ç»Ÿå¼€å‘** â†’ **ä½¿ç”¨å¢å¼ºç‰ˆ**
- **æœºå™¨äººæ¨¡æ‹Ÿ** â†’ **ä½¿ç”¨å¢å¼ºç‰ˆ**
- **æ¼”ç¤ºå±•ç¤º** â†’ ä½¿ç”¨åŸºç¡€ç‰ˆ

## ğŸ“š è¯¦ç»†æ–‡æ¡£

### å¢å¼ºæŸ¥çœ‹å™¨ç›¸å…³

1. **[å¢å¼ºæŸ¥çœ‹å™¨æŒ‡å—](ENHANCED_VIEWER_GUIDE.md)** â­
   - åŠŸèƒ½ç‰¹æ€§è¯´æ˜
   - æŠ€æœ¯å®ç°ç»†èŠ‚
   - ä½¿ç”¨æ–¹æ³•
   - å¸¸è§é—®é¢˜

2. **[æŸ¥çœ‹å™¨å¯¹æ¯”](VIEWER_COMPARISON.md)**
   - åŠŸèƒ½å¯¹æ¯”è¡¨
   - æ€§èƒ½å¯¹æ¯”
   - ä½¿ç”¨åœºæ™¯å»ºè®®
   - å‡çº§è·¯å¾„

### åŸºç¡€æµ‹è¯•ç›¸å…³

3. **[å¿«é€Ÿå¼€å§‹](QUICK_START.md)**
   - ç¯å¢ƒé…ç½®
   - åŸºç¡€ä½¿ç”¨

4. **[Habitatæµ‹è¯•æŒ‡å—](HABITAT_TEST_GUIDE.md)**
   - Habitaté›†æˆæµ‹è¯•
   - é—®é¢˜æ’æŸ¥

## ğŸ”§ æŠ€æœ¯å®ç°

### NavMeshè®¡ç®— (å¢å¼ºç‰ˆ)

å‚è€ƒHabitatå®˜æ–¹`examples/viewer.py`å®ç°ï¼š

```python
def _compute_navmesh(self):
    """è®¡ç®—NavMeshå¯é€šè¡ŒåŒºåŸŸ"""
    self.navmesh_settings = habitat_sim.NavMeshSettings()
    self.navmesh_settings.set_defaults()
    self.navmesh_settings.agent_height = agent_cfg.height
    self.navmesh_settings.agent_radius = agent_cfg.radius
    self.navmesh_settings.include_static_objects = True
    
    self.sim.recompute_navmesh(
        self.sim.pathfinder, 
        self.navmesh_settings
    )
```

### æœºå™¨ç‹—è·Ÿéš (å¢å¼ºç‰ˆ)

```python
def _update_robot_position(self):
    """æ›´æ–°æœºå™¨ç‹—ä½ç½®ä»¥è·ŸéšAgent"""
    agent_state = self.agent.get_state()
    robot_pos = agent_state.position.copy()
    robot_pos[1] = 0.0  # ç¡®ä¿åœ¨åœ°é¢ä¸Š
    
    self.robot_obj.translation = robot_pos
    self.robot_obj.rotation = agent_state.rotation
```

## ğŸ› å·²çŸ¥é—®é¢˜

1. **NavMeshå¯è§†åŒ–**
   - é—®é¢˜: éœ€è¦æŒ‰Né”®æ‰‹åŠ¨åˆ‡æ¢
   - çŠ¶æ€: æ­£å¸¸è¡Œä¸º (å‚è€ƒå®˜æ–¹å®ç°)

2. **OpenCVä¿®é¥°é”®**
   - é—®é¢˜: Shift/Altæ£€æµ‹ä¸ç¨³å®š
   - è§£å†³: ä½¿ç”¨å•ç‹¬æŒ‰é”®(N)ä½œä¸ºä¸»è¦åŠŸèƒ½

3. **æœºå™¨ç‹—åŠ è½½**
   - é—®é¢˜: éƒ¨åˆ†URDFæ–‡ä»¶å¯èƒ½åŠ è½½å¤±è´¥
   - è§£å†³: æ£€æŸ¥URDFè·¯å¾„å’Œæ–‡ä»¶å®Œæ•´æ€§

## ğŸ“ å‚è€ƒèµ„æº

- **Habitatå®˜æ–¹Viewer**: `habitat-sim/examples/viewer.py`
- **NavMeshæ–‡æ¡£**: https://aihabitat.org/docs/habitat-sim/nav.html
- **ç‰©ç†å¼•æ“æ–‡æ¡£**: https://aihabitat.org/docs/habitat-sim/physics.html
- **ArticulatedObjectæ–‡æ¡£**: https://aihabitat.org/docs/habitat-sim/physics.html#articulated-objects

## ğŸ¯ æ¨èå·¥ä½œæµ

### åœºæ™¯å¼€å‘æµç¨‹

1. **åˆ›å»ºåœºæ™¯** â†’ ä½¿ç”¨Blender/å…¶ä»–3Då·¥å…·
2. **å¿«é€ŸéªŒè¯** â†’ è¿è¡ŒåŸºç¡€æŸ¥çœ‹å™¨ (`test_habitat_interactive.py`)
3. **å¯¼èˆªæµ‹è¯•** â†’ è¿è¡Œå¢å¼ºæŸ¥çœ‹å™¨ (`test_habitat_interactive_enhanced.py`)
4. **å®Œæ•´æµ‹è¯•** â†’ è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯• (`test_end_to_end.py`)

### æœºå™¨äººé›†æˆæµç¨‹

1. **å‡†å¤‡URDF** â†’ é…ç½®`configs/environment_config.yaml`
2. **åŠ è½½æµ‹è¯•** â†’ è¿è¡Œå¢å¼ºæŸ¥çœ‹å™¨
3. **è·ŸéšéªŒè¯** â†’ ä½¿ç”¨WASDæ§åˆ¶ï¼Œè§‚å¯Ÿæœºå™¨ç‹—
4. **åŠŸèƒ½æµ‹è¯•** â†’ æµ‹è¯•NavMeshå’Œè·¯å¾„è§„åˆ’

---

**æœ€åæ›´æ–°**: 2025-12-11  
**ç»´æŠ¤è€…**: VLM Navigation System Team  
**æ¨èæŸ¥çœ‹å™¨**: `test_habitat_interactive_enhanced.py` â­
